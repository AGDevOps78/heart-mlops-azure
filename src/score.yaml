$schema: https://azuremlschemas.azureedge.net/latest/managedOnlineDeployment.schema.json
name: fastapi-deploy
endpoint_name: heart-endpoint

model:
  path: ./outputs/best_model.pkl

environment:
  name: fastapi-env
  image: mcr.microsoft.com/azureml/minimal-ubuntu20.04-py38-cpu-inference:latest
  conda_file: environment.yml

code_configuration:
  code: .
  scoring_script: score.py

instance_type: Standard_DS2_v2
instance_count: 1

liveness_probe:
  initial_delay: 10
  period: 10
  timeout: 2
  success_threshold: 1
  failure_threshold: 3

request_settings:
  request_timeout_ms: 60000
  max_queue_wait_ms: 60000